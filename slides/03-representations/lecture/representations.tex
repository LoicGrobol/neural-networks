% LTeX: language=fr
% Copyright ¬© 2023, Lo√Øc Grobol <loic.grobol@gmail.com>
% This document is available under the terms of the Creative Commons Attribution 4.0 International License (CC BY 4.0) (https://creativecommons.org/licenses/by/4.0/)

% Settings
\newcommand\myname{L. Grobol}
\newcommand\mylab{MoDyCo, Universit√© Paris Nanterre}
\newcommand\pdftitle{Apprentissage Automatique‚ÄØ: repr√©sentation des donn√©es}
\newcommand\mymail{lgrobol@parisnanterre.fr}
\newcommand\titlepagetitle{\pdftitle}
\newcommand\eventname{M2 Plurital}
\newcommand\eventvenue{Nanterre, France}
\newcommand\eventdate{2024-12-04}

\documentclass[
	xcolor={svgnames},
	aspectratio=169,
	french,
]{beamer}
% Colour palettes from [Paul Tol's technical note](https://personal.sron.nl/~pault/data/colourschemes.pdf) v3.1
% Bright scheme
\definecolor{sronbrightblue}{RGB}{68, 119, 170}
\definecolor{sronbrightcyan}{RGB}{102, 204, 238}
\definecolor{sronbrightgreen}{RGB}{34, 136, 51}
\definecolor{sronbrightyellow}{RGB}{204, 187, 68}
\definecolor{sronbrightred}{RGB}{238, 102, 119}
\definecolor{sronbrightpurple}{RGB}{170, 51, 119}
\definecolor{sronbrightgrey}{RGB}{187, 187, 187}

% Divergent colour scheme (fig 19 in Paul Tol's note)
\definecolor{ptolD01}{RGB}{232,236,251}
\definecolor{ptolD02}{RGB}{217,204,227}
\definecolor{ptolD03}{RGB}{209,187,215}
\definecolor{ptolD04}{RGB}{202,172,203}
\definecolor{ptolD05}{RGB}{186,141,180}
\definecolor{ptolD06}{RGB}{174,118,163}
\definecolor{ptolD07}{RGB}{170,111,158}
\definecolor{ptolD08}{RGB}{153,79,136}
\definecolor{ptolD09}{RGB}{136,46,114}
\definecolor{ptolD10}{RGB}{25,101,176}
\definecolor{ptolD11}{RGB}{67,125,191}
\definecolor{ptolD12}{RGB}{82,137,199}
\definecolor{ptolD13}{RGB}{97,149,207}
\definecolor{ptolD14}{RGB}{123,175,222}
\definecolor{ptolD15}{RGB}{78,178,101}
\definecolor{ptolD16}{RGB}{144,201,135}
\definecolor{ptolD17}{RGB}{202,224,171}
\definecolor{ptolD18}{RGB}{247,240,86}
\definecolor{ptolD20}{RGB}{246,193,65}
\definecolor{ptolD22}{RGB}{241,147,45}
\definecolor{ptolD24}{RGB}{232,96,28}
\definecolor{ptolD25}{RGB}{230,85,24}
\definecolor{ptolD26}{RGB}{220,5,12}
\definecolor{ptolD27}{RGB}{165,23,14}
\definecolor{ptolD28}{RGB}{114,25,14}
\definecolor{ptolD29}{RGB}{66,21,10}

\definecolor{sronmutedindigo}{RGB}{51,34,136}

% And my favourite purple
\definecolor{myfavouritepurple}{RGB}{113, 10, 186}
\definecolor{electricindigo}{RGB}{111, 0, 255}
\definecolor{neonpink}{RGB}{255, 68, 204}


\usetheme[
	sectionpage=progressbar,
	subsectionpage=progressbar,
	progressbar=frametitle,
]{metropolis}
	\colorlet{accent}{neonpink}
	\setbeamercolor{frametitle}{
		use=normal text,
		bg=normal text.bg,
		fg=accent,
	}
	\setbeamercolor{alerted text}{fg=accent}
	\setbeamercolor{progress bar}{fg=accent}
	\makeatletter
		\setlength{\metropolis@progressinheadfoot@linewidth}{0.5pt}
	\makeatother

% Left-align description lists
\defbeamertemplate{description item}{align left}{\insertdescriptionitem\hfill}
\setbeamertemplate{description item}[align left]

% Use non-standard fonts
\usepackage{fontspec}
	\usefonttheme{professionalfonts}

	\directlua{
		luaotfload.add_fallback(
			"myfallback",
			{
				"NotoColorEmoji:mode=harf;",
				"NotoSans:mode=harf;",
				"DejaVuSans:mode=harf;",
			}
		)
	}
	
	\setsansfont{Fira Sans}[
		BoldFont={* Semibold},
		RawFeature={fallback=myfallback;multiscript=auto;},
	]
	\setmonofont[Scale=0.9]{Fira Mono}
	\newfontfamily\fallbackfont{Deja Vu Sans}
	\newfontfamily\emojifont{Noto Color Emoji}[Renderer=HarfBuzz]
	\frenchspacing

% Fix missing glyphs in Fira by delegating to polyglossia/babel
\usepackage{newunicodechar}
	\newunicodechar{‚ÄØ}{~}   % U+202F NARROW NO-BREAK SPACE
	\newunicodechar{‚Äâ}{ }   % U+2009 THIN SPACE

% Notes on left screen
% \usepackage{pgfpages}
% \setbeameroption{show notes on second screen=left}

\usepackage{polyglossia}
	\setmainlanguage{french}
	\setotherlanguage[variant=british]{english}
	\setotherlanguage{breton}
	\NewDocumentCommand\borrowing{ m m }{
		\textlang{#1}{\textit}	
	}
\usepackage{amsfonts,amssymb}
\usepackage{amsmath,amsthm}
\usepackage{mathtools}	% AMS Maths service pack
	\newtagform{brackets}{[}{]}	% Pour des lignes d'√©quation num√©rot√©es entre crochets
	\mathtoolsset{showonlyrefs, showmanualtags, mathic}	% affiche les tags manuels (\tag et \tag*) et corrige le kerning des maths inline dans un bloc italique voir la doc de mathtools
	\usetagform{brackets}	% Utilise le style de tags d√©fini plus haut
\usepackage{lualatex-math}

\usepackage[math-style=french]{unicode-math}
	\setmathfont[Scale=1.3]{Libertinus Math}
\usepackage{newunicodechar}
	\newunicodechar{‚àö}{\sqrt}
\usepackage{mleftright}

% Fix incompatibility with unicode-math
\let\UnicodeMathMathBfSfIt\mathbfsfit
\let\mathbfsfit\relax
\usepackage{mismath}
\let\mathbfsfit\UnicodeMathMathBfSfIt

\usepackage{covington}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{siunitx}
	\sisetup{
		detect-all,
		group-separator=\text{\,},
	}
	\DeclareSIUnit{\quantity}{\relax}
	\DeclareSIUnit{\words}{words}
	\DeclareSIUnit{\sentences}{sentences}
	% Needed for italics and bold numbers in siunitx S-aligned columns
	\robustify\itshape
	\robustify\bfseries
\usepackage{multicol}
\usepackage{ccicons}
\usepackage{bookmark}
\usepackage{caption}
	\captionsetup{skip=1ex, labelformat=empty}
\usepackage{lua-ul}
% \usepackage{minted}
% 	\usemintedstyle{lovelace}
% 	\setminted{autogobble, fontsize=\normalsize, tabsize=4}
% 	\setmintedinline{fontsize=auto}
% 	\RenewDocumentCommand\listingscaption{}{Example} 

\usepackage[
	english=american,
	french=guillemets,
	autostyle=true,
]{csquotes}
	\renewcommand{\mkbegdispquote}[2]{\itshape\let\emph\textbf}
	% Like `\foreignquote` but use the outside language's quotes not the inside's
	\NewDocumentCommand\quoteforeign{m m}{\enquote{\textlang{#1}{\textit{#2}}}}

\usepackage{tikz}
	\NewDocumentCommand\textnode{O{}mm}{
		\tikz[remember picture, baseline=(#2.base), inner sep=0pt]{\node[#1] (#2) {#3};}
	}
	\NewDocumentCommand\mathnode{O{}mm}{
		\tikz[remember picture, baseline=(#2.base), inner sep=0pt]{\node[#1] (#2) {\(\displaystyle #3\)};}
	}
	% Beamer utilities
	\tikzset{
		alt/.code args={<#1>#2#3}{%
		  \alt<#1>{\pgfkeysalso{#2}}{\pgfkeysalso{#3}} % \pgfkeysalso doesn't change the path
		},
		invisible/.style={opacity=0},
		visible on/.style={alt={<#1>{}{invisible}}},
		accent on/.style={alt={<#1>{draw=accent, text=accent, thick}{draw}}},
	}
	% Misc utilities
	\tikzset{
		true scale/.style={scale=#1, every node/.style={transform shape}},
	}
	% Custom styles
	\tikzset{
		>=stealth,
		hair lines/.style={line width = 0.05pt, lightgray},
		accent on/.style={alt={<#1>{draw=accent, text=accent, thick}{draw}}},
		true scale/.style={scale=#1, every node/.style={transform shape}},
	}	

	\usetikzlibrary{tikzmark}
	\usetikzlibrary{matrix, chains, graphs, graphdrawing}
	\usetikzlibrary{shapes, shapes.geometric}
	\usetikzlibrary{decorations.pathreplacing}
	\usetikzlibrary{decorations.pathmorphing}
	\usetikzlibrary{positioning, calc, intersections}
	\usetikzlibrary{fit}

% % Highlight formulas
% \usepackage[beamer, markings]{hf-tikz}

% \usepackage{forest}
% 	\useforestlibrary{linguistics}

% \usepackage{tikz-dependency}

% Plots
\usepackage{pgfplots}
	\pgfplotsset{compat=1.18}
	% Due to pgfplots meddling with pgfkeys, we have to redefine alt here.
	\pgfplotsset{
		alt/.code args={<#1>#2#3}{%
		\alt<#1>{\pgfkeysalso{#2}}{\pgfkeysalso{#3}} % \pgfkeysalso doesn't change the path
		},
	}
	\pgfplotsset{compat=1.18}
	\pgfplotsset{colormap={SRON}{rgb255=(61,82,161) rgb255=(255,250,210) rgb255=(174,28,62)}} % chktex 36

% \usepackage{robust-externalize}

	% \robExtConfigure{
	% 	add to preset={tikz}{
	% 	% we load some packages that will be loaded by figures based on the tikz preset
	% 	add to preamble={\usepackage{pifont}}
	% 	}
	% }

\usepackage[
	block=ragged,
	dashed=false,
	doi=false,
	isbn=false,
	maxbibnames=6,
	maxcitenames=2,
	minbibnames=1,
	mincitenames=1,
	uniquelist=false,
	useprefix=true,
	style=authoryear,
]{biblatex}
	% No small caps in french bib
	\DefineBibliographyExtras{french}{\restorecommand\mkbibnamefamily}
	\AtEveryBibitem{
		\ifentrytype{online}
		{} {
			\iffieldequalstr{howpublished}{online}
			{
				\clearfield{howpublished}
			} {
				\clearfield{urlyear}\clearfield{urlmonth}\clearfield{urlday}
			}
		}
	}
	% Fix bug with \insertbiblabel in author-date, see https://tex.stackexchange.com/questions/585635/beamer-biblatex-authoryear-causes-problem-with-insertbiblabel and https://github.com/josephwright/beamer/blob/865a19d4ec64f4c8e4935c19e162b8f4fd5aa190/base/beamerbaselocalstructure.sty#L501
	\let\insertbiblabel\relax
	\addbibresource{biblio.bib}
 
% Compact bibliography style
\setbeamertemplate{bibliography item}[text]

\AtEveryBibitem{
	\clearfield{series}
	\clearfield{pages}
	\clearname{editor}
}
\renewcommand*{\bibfont}{\tiny}

\usepackage{hyperxmp}	% XMP metadata

\usepackage[type={CC},modifier={by},version={4.0}]{doclicense}

% \usepackage{todonotes}
% 	\let\todox\todo
% 	\renewcommand\todo[1]{\todox[inline]{#1}}

\title{\titlepagetitle}
\author{\textbf{\myname}~(\mylab)}
\institute{}
\date{\eventname\\\eventvenue, \eventdate}

\titlegraphic{\ccby}

% Commands sp√©cifiques
\NewDocumentCommand\shorturl{ O{https} O{://} m }{%
	\href{#1#2#3}{\nolinkurl{#3}}%
}

\DeclarePairedDelimiterX\compset[2]{\lbrace}{\rbrace}{#1\,\delimsize|\,#2}
\DeclarePairedDelimiterX\innprod[2]{\langle}{\rangle}{#1\,\delimsize|\,#2}

% Easy column vectors \vcord{a,b,c} ou \vcord[;]{a;b;c}
% Here be black magic
\ExplSyntaxOn % chktex 1
	\NewDocumentCommand{\vcord}{O{,}m}{\vector_main:nnnn{p}{\\}{#1}{#2}}
	\NewDocumentCommand{\tvcord}{O{,}m}{\vector_main:nnnn{psmall}{\\}{#1}{#2}}
	\seq_new:N\l__vector_arg_seq
	\cs_new_protected:Npn\vector_main:nnnn #1 #2 #3 #4{
		\seq_set_split:Nnn\l__vector_arg_seq{#3}{#4}
		\begin{#1matrix}
			\seq_use:Nnnn\l__vector_arg_seq{#2}{#2}{#2}
		\end{#1matrix}
	}
\ExplSyntaxOff % chktex 1

\NewDocumentCommand\itpause{}{%
	\addtocounter{beamerpauses}{-1}%
	\pause%
}

\NewDocumentCommand\graphdot{O{fill=ptolD10} r() O{0.5ex}}{\path[#1] (#2) circle (#3)}


% ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
% ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà    ‚ñà‚ñà
% ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà  ‚ñà‚ñà    ‚ñà‚ñà
% ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà  ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà    ‚ñà‚ñà
% ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà      ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà

\begin{document}
\pdfbookmark[2]{Title}{title}

\begin{frame}[plain]
	\titlepage
\end{frame}

\begin{frame}[label=kevrin, standout]
	\quoteforeign{breton}{kevrin}‚ÄØ: nom ou verbe‚ÄØ?
\end{frame}

\begin{frame}<1>[label=lexicon, plain]
	% See <https://tex.stackexchange.com/a/154322> for why the mboxes
	\begin{columns}
		\column{0.49\textwidth}
			\begin{description}
				\item[\textlang{breton}{sardin}] \mbox{}\visible<2->{sardine}
				\item[\textlang{breton}{gwez}] \mbox{}\visible<2->{arbres}
				\item[\textlang{breton}{reizh}] \mbox{}\visible<2->{genre}
				\item[\textlang{breton}{kentel}] \mbox{}\visible<2->{le√ßon}
				\item<3>[\alert{\textlang{breton}{kevrin}}] \alert{secret}
			\end{description}
		\column{0.49\textwidth}
			\begin{description}
				\item[\textlang{breton}{labourin}] \mbox{}\visible<2->{travailler-fut-1sg}
				\item[\textlang{breton}{c'hoarzhec'h}] \mbox{}\visible<2->{rire-ipfv-2pl}
				\item[\textlang{breton}{so√±jont}] \mbox{}\visible<2->{penser-pres-3pl}
				\item[\textlang{breton}{graet}] \mbox{}\visible<2->{aller-pst-ptcp}
			\end{description}
	\end{columns}
\end{frame}

\againframe[standout]{kevrin}

\againframe<2>{lexicon}

\againframe[standout]{kevrin}

\begin{frame}<-2>[fragile, plain]
	\begin{center}
		\begin{tikzpicture}
			% Population 1
			\node at (-5.771476230191826,3.8908509886473874) {sardin};
			\node at (-5.731442869057548,2.9834281362704065) {gwez};
			\node at (-4.276897414512093,2.863328052867571) {reizh};
			\node at (-3.7297748123436194,3.864162081224535) {kentel};

			% Population 2
			\node at (2.4487072560467054,-1.3268304125202521) {labourin};
			\node at (2.2351959966638866,-2) {c'hoarzhec'h};
			\node at (2.6488740617180984,-2.4877978854143303) {so√±jont};
			\node at (3.6363636363636362,-2.7813758670657065) {graet};

			\node[visible on={2}, color=electricindigo] at (-3, 2) {kevrin};
		\end{tikzpicture}
	\end{center}
\end{frame}

\againframe[standout]{kevrin}

\againframe<3>{lexicon}

\begin{frame}{Machine}
	Les algos d'apprentissage marchent plut√¥t sur des nombres ou souvent des s√©ries de nombres
	(parce qu'on peut les voir comme des points dans un espace g√©om√©trique)  On a donc un probl√®me
	constant qui est‚ÄØ: 

	Comment transformer nos donn√©es (texte, signal sonore, images, vid√©o) en nombres‚ÄØ?
\end{frame}

\begin{frame}{M√©thodes imm√©diates}
	En soi on a toujours une solution‚ÄØ: \pause de fait, si on a des donn√©es sous forme num√©rique (dans une
	machine), elles sont comme leur nom l'indique num√©rique (repr√©sent√©es par des nombres, vous
	suivez‚ÄØ?)

	Ces repr√©sentations peuvent √™tre bien (par exemple le codage num√©rique des images traduit une
	r√©alit√© physique/perceptive du coup, c'est pas mal) ou pas du tout (une suite de nombres
	repr√©sentant des points de code Unicode qui repr√©sentent des caract√®res, c'est assez √©loign√© de la
	fa√ßon dont on pense le langage).

	\pause

	√áa ne veut pas dire que c'est impossible de se servir de √ßa, mais plut√¥t que c'est pas toujours
	la meilleure solution. √áa d√©pend de beaucoup de facteurs.
\end{frame}

\begin{frame}[standout]
	Comment repr√©senter des donn√©es linguistiques √©crites‚ÄØ?
\end{frame}

\begin{frame}{Repr√©senter les mots}
	On peut repr√©senter les mots comme des nombres en constituant un \alert{lexique} et en affectant
	√† chaque item un nombre entier‚ÄØ: sa position dans l'ordre lexicographique.

	\pause

	\begin{description}
		\item[a] \num{0}
		\item[aa] \num{1}
		\item[abaca] \num{2}
		\item[abaissa] \num{3}
		\item[‚Ä¶] ‚Ä¶ 
	\end{description}

	\pause

	Alors un mot, c'est juste un nombre et une suite de mots (phrase, tour de parole, document‚Ä¶)
	c'est juste une suite de nombres.
\end{frame}

\begin{frame}[standout]
	Est-ce que vous voyez des probl√®mes‚ÄØ?
\end{frame}

\begin{frame}{Une affaire de topologie}
	Un probl√®me assez probl√©matique, c'est que ces repr√©sentations num√©riques sont purement
	\alert{orthographiques}, ce qui n'est pas id√©al.

	\pause

	D√©j√†, c'est un nid √† probl√®mes li√©s √† la standardisation.

	\pause

	Mais m√™me si on en fait abstraction‚ÄØ:

	\begin{description}
		\item[‚Ä¶] ‚Ä¶
		\item[d√©fi√©s] \num{41921}
		\item[d√©flagration] \num{41922}
		\item[‚Ä¶] ‚Ä¶ 
	\end{description}

	\pause

	On a des mots qui n'ont presque rien en commun, mais dont les \alert{repr√©sentations} sont tr√®s
	proches.

	\pause

	√áa sera un probl√®me pour beaucoup des algorithmes d'apprentissage.
\end{frame}

\begin{frame}<-4>[fragile]{Une solution de math√©maticien‚ãÖne} Il y a une fa√ßon de repr√©senter un
	lexique √† peine plus compliqu√©e qui √©vite ce probl√®me‚ÄØ: un encodage
	\quoteforeign{english}{\alert{one-hot}}‚ÄØ: on repr√©sente chaque mot par un \alert{vecteur} avec
	des z√©ros partout, sauf √† sa position dans le lexique o√π on met un \num{1}.

	\pause

	Par exemple \enquote{chat} est en position \num{2332}, on va donc le repr√©senter par

	\begin{equation}
		\vcord{\mathnode{vectop}{0},0,‚ãÆ,0,\mathnode{one}{1},0,‚ãÆ,\mathnode{vecbottom}{0}}
	\end{equation}
	\tikz[overlay, remember picture]{
		\draw[->] ($(one)+(2em, 0)$) node[right] {\num{2332}} -- (one);
		\draw[visible on={4-}, decorate, decoration={brace, mirror, amplitude=1ex}]
			($(vectop.north)+(-2ex, 0)$) -- ($(vecbottom.south)+(-2ex, 0)$) node [midway, xshift=-1ex, anchor=east] 
			{\num{142695}}
		;
	}
\end{frame}

\begin{frame}{Une solution de math√©maticien‚ãÖne}
	Dans cette configuration, quelle est la distance (euclidienne) entre deux mots‚ÄØ?

	\pause

	Est-ce que √ßa r√©sout le probl√®me pr√©c√©dent‚ÄØ?

	\pause

	Est-ce que vous voyez d'autres probl√®mes avec cette repr√©sentation‚ÄØ?
\end{frame}

\begin{frame}[standout]
	Des id√©es pour faire mieux‚ÄØ?
\end{frame}

\begin{frame}{Une solution de linguiste}
	Si on dispose d'un lexique annot√© (au hasard JeuxDeMots
	\parencite{lafourcade2020JeuxDeMotsReseauLexicosemantique}), on peut aller dans la direction
	carr√©ment oppos√©e‚ÄØ: repr√©senter chaque mot par une \alert{structure de traits linguistiques}.

	\pause

	\begin{equation}
		\vcord{\text{NOUN},\text{singular},\text{animated},‚ãÆ}
	\end{equation}

	\pause

	Est-ce que √ßa r√©sout nos probl√®mes pr√©c√©dents‚ÄØ?

	\pause

	Est-ce que √ßa en cr√©√© d'autres‚ÄØ?
\end{frame}

\begin{frame}{Une solution de linguiste \emph{de corpus}}

	\begin{center}
		{\large\quoteforeign{english}{\alert{You shall know a word by the company it keeps.}}}
		
		\parencite{firth1957SynopsisLinguisticTheory}
	\end{center}

	\pause

	\vfill
	{\footnotesize Voir par exemple \textcite{brunila2022WhatCompanyWords} pour une mise en contexte plut√¥t n√©cessaire.}
\end{frame}

\begin{frame}{Une solution de langouste}
	Bien entendu on va s'empresser d'oublier toute nuance sur cette citation et d'en tirer une id√©e
	pas forc√©ment parfaite mais \alert{pratique}.

	\pause

	On va faire l'hypoth√®se sauvage que des mots qui apparaissent dans des \alert{contextes}
	similaires ont des propri√©t√©s similaires.

	\pause

	√áa nous donne une solution op√©rante pour repr√©senter des mots‚ÄØ: on va les repr√©senter par les
	contextes dans lesquels ils apparaissent.

	\pause

	En g√©n√©ral‚ÄØ: leurs fr√©quences de cooccurrence avec chacun des mots d'un lexique dans un grand
	corpus.
\end{frame}

\begin{frame}{Cooccurrences}
	Repr√©senter un mot par des fr√©quences de cooccurrences, √ßa donne toujours des vecteurs de la
	taille du lexique, \alert<1>{mais}‚ÄØ:

	\pause

	\begin{itemize}[<+->]
		\item Beaucoup moins creux (moins de z√©ros).
		\item Dont la \alert{topologie}, l'organisation spatiale, a plus d'int√©r√™t.
	\end{itemize}

	\pause

	La grande dimension est toujours un probl√®me, mais il y a des techniques pour la r√©duire,
	\alert{compresser} les vecteurs en gardant, voire am√©liorant l'int√©r√™t de leur
	\alert{g√©om√©trie}.
\end{frame}

\begin{frame}[standout]
	Quel rapport avec l'apprentissage automatique‚ÄØ?
\end{frame}

\begin{frame}{Apprendre des repr√©sentations}
	On a ici \alert{appris} des repr√©sentations‚ÄØ: on a exploit√© des \alert{r√©gularit√©s} rep√©r√©es
	dans un \alert{√©chantillon de donn√©es}.

	\pause

	On l'a fait ici avec un m√©canisme tr√®s \emph{ad hoc}, mais il y a d'autres solutions.

	\pause

	Notamment la plus populaire et celle qui va nous pr√©occuper maintenant‚ÄØ: utiliser des
	repr√©sentations apprises pour une \alert{t√¢che auxiliaire} pour laquelle les donn√©es abondent.
\end{frame}

\begin{frame}[fragile]{???}
	En fait, ce qui se passe dans beaucoup de mod√®les d'apprentissage, √ßa ressemble √†

	\begin{figure}
        \begin{tikzpicture}
            \graph[grow right sep, nodes={ellipse, draw}]{
				Entr√©e -> Repr√©sentation -> Sortie
			};
        \end{tikzpicture}
	\end{figure}

	\pause

	Le mod√®le apprend √† la fois une transformation des entr√©es en des \alert{repr√©sentations
	interm√©diaires} pertinentes pour lui et √† d√©terminer une sortie √† partir de ces repr√©sentations.

	\pause

	Si on applique un tel mod√®le √† une t√¢che qui demande des repr√©sentations int√©ressantes et pour
	laquelle on a facilement des donn√©es, on pourra alors extraire ces repr√©sentations et les
	utiliser pour d'autres t√¢ches.
\end{frame}

\begin{frame}{‚ö†Ô∏è}
	√âvidemment ce que vous obtenez d√©pend tr√®s fortement de vos donn√©es et de la t√¢che.

	\pause

	Les donn√©es faciles √† obtenir c'est bien pratique, mais c'est aussi dangereux (on en a d√©j√†
	parl√©, on en reparlera etc).
\end{frame}

\begin{frame}{üêç}
	Est-ce que le serpent ne se mord pas un peu la queue‚ÄØ?

	\pause

	Pour cette t√¢che auxiliaire, on prend quoi comme repr√©sentation de d√©part‚ÄØ?

	\pause

	En fait on peut prendre un peu ce qu'on veut tant qu'on perd pas d'information‚ÄØ: on est de toute
	fa√ßon pas tr√®s int√©ress√©‚ãÖe par le mod√®le de la t√¢che auxiliaire en soi. Tout ce qu'on veut,
	c'est qu'elle apprenne des bonnes repr√©sentations interm√©diaires.

	\pause

	En pratique‚ÄØ: souvent des vecteurs \emph{one-hot} pour les mots. On pourrait faire du bootstrap,
	mais √† ma connaissance √ßa ne se fait pas vraiment en pratique.
\end{frame}

\begin{frame}{T√¢ches auxiliaires}
	Quelles t√¢ches‚ÄØ?

	\pause

	\begin{itemize}[<+->]
		\item Suffisamment complexe.
		\item Facilement beaucoup de donn√©es.
	\end{itemize}

	\pause

	Le plus populaire en TAL, ce sont des formes de \enquote{\alert{mod√®les de langue}}.

	\pause

	Par exemple g√©n√©ratif‚ÄØ: \enquote{Le petit chat est
	\textunderscore\textunderscore\textunderscore} ‚Üê quelle est la proba pour chacun des mots du
	vocabulaire de continuer la phrase‚ÄØ?

	\pause

	C'est historiquement ce que fait \textcite{bengio2006NeuralProbabilisticLanguage}.
	
	\pause
	
	C'est ce que fait \textcite{mikolov2013EfficientEstimationWord} avec plusieurs mod√®les de
	vraisemblance partielles (en regardant en biais).
\end{frame}

\begin{frame}{Ces fameux \emph{embeddings}}
	Ce que \textcite{bengio2006NeuralProbabilisticLanguage},
	\textcite{mikolov2013EfficientEstimationWord} et les autres obtiennent ce sont des
	\alert{repr√©sentations vectorielles} de \alt<+>{mots}{\strikeThrough{mots} formes
	orthographiques}.

	\pause

	Fondamentalement, on a un \alert{dictionnaire} qui associe √† chaque forme orthographique un
	vecteur qui contient des \strikeThrough{trucs} informations sur son usage observ√© dans un
	corpus.

	\pause

	On les appelle \alert{embeddings} (ou \emph{plongements}) pour des raisons. Ce sont des vecteurs
	denses (peu de z√©ros), de dimensions tr√®s inf√©rieures √† la taille du lexique. Tout ce que les
	algos d'apprentissage (en particulier les r√©seaux de neurones) aiment bien.

	\pause

	C'est difficile de les √©valuer intrins√®quement (m√™me si
	\citeauthor{mikolov2013EfficientEstimationWord} propose des id√©es sur les liens
	g√©om√©trie-s√©mantique), mais on observe en pratique que \alert{pr√©-entra√Æner} ainsi des
	repr√©sentations aide pour des t√¢ches en aval.
\end{frame}

\begin{frame}{La tuyauterie des donn√©es}
	Si on revient √† notre objectif initial \pause qui √©tait‚ÄØ?

	\pause

	Quelles repr√©sentations pour nos donn√©es dans un algo d'apprentissage pour une \alert{t√¢che}
	pr√©cise‚ÄØ?

	\pause

	Une solution tr√®s orthodoxe‚ÄØ: un probl√®me d'apprentissage‚ÄØ? \pause R√©solvons-le avec deux fois
	plus d'apprentissage‚ÄØ:
	
	\pause

	\begin{itemize}[<+->]
		\item Une premi√®re phase exploite des \alert{r√©gularit√©s} sur des donn√©es qui n'ont pas √©t√©
		annot√©es pour cette t√¢che. Nombreuses, \enquote{bon march√©} et peu sp√©cifiques \pause‚ÄØ: par
		exemple un corpus de texte brut genre OSCAR
		\parencite{ortizsuarez2019AsynchronousPipelineProcessing} et en apprend ce faisant des
		repr√©sentations.
		\item La deuxi√®me apprend des corr√©lations entre \alert{ces} repr√©sentations et des
		informations contenues dans des donn√©es \alert{annot√©es sp√©cifiquement} \pause‚ÄØ: par exemple
		un treebank comme Sequoia \parencite{candito2012CorpusSequoiaAnnotation}.
	\end{itemize}
\end{frame}

\begin{frame}[standout]
	Opinions‚ÄØ?
\end{frame}

\begin{frame}{Une note}
	Si pour plusieurs t√¢ches aval on a l'intention d'utiliser le m√™me pr√©-entra√Ænement de
	repr√©sentations, on est pas oblig√© de recommencer √† chaque fois‚ÄØ!

	\pause

	On a donc potentiellement des repr√©sentations \alert{polyvalentes}.

	\pause

	Et √ßa permet de faire des √©conomies assez importantes.
\end{frame}

\begin{frame}{Encore des probl√®mes}
	Ces repr√©sentations de formes, √ßa marche \strikeThrough{bien} pas si pire pour beaucoup de
	choses, mais elles ont d√©faut majeur.

	\pause

	Ce sont des repr√©sentations de \alert{formes}.

	\pause

	Les homo(graphes|nymes) √ßa existe.

	\pause

	Comment faire pour que deux formes identiques de lex√®mes diff√©rents, ou issues d'un syncr√©tisme
	morphologique d'un m√™me lex√®me aient des repr√©sentations diff√©rentes‚ÄØ?
\end{frame}

\begin{frame}{D√©sambig√ºiser}
	Peut-√™tre on pourrait au pr√©alable d√©sambig√ºiser‚ÄØ?

	\pause

	Comment‚ÄØ?

	\pause

	{\footnotesize Avec un mod√®le appris‚ÄØ? üëâüëà}
\end{frame}

\begin{frame}{D√©sambig√ºiser}
	Le plan √ßa pourrait √™tre‚ÄØ:

	\begin{enumerate}[<+->]
		\item On apprend des repr√©sentations de formes
		\item On les utilise comme entr√©es dans un mod√®le qui saurait d√©sambig√ºiser des formes
		\item Le mod√®le qui r√©alise notre t√¢che cible finale a donc acc√®s √† des repr√©sentations des
		      formes, sans les ambig√ºit√©s
	\end{enumerate}

	\pause

	Est-ce que √ßa vous donner une id√©e lumineuse‚ÄØ?
\end{frame}

\begin{frame}{Wavelength collapse}
	Un mod√®le de d√©sambig√ºisation va d√©sambig√ºiser en utilisant des repr√©sentations des formes
	\alert{en contexte}.

	\pause

	Il va donc y avoir dedans des repr√©sentations de chacune des formes \alert{dans son contexte}.

	\pause

	C'est encore mieux qu'une d√©sambig√ºisation arbitraire‚ÄØ: si on a de la chance √ßa pourrait
	capturer des nuances qu'on a pas annot√© explicitement.

	\pause

	Le plan √ßa pourrait donc √™tre de prendre directement ces repr√©sentations‚ÄØ: quand on nous donne
	une entr√©e, on la passe au mod√®le de d√©sambig√ºisation, on intercepte ses repr√©sentations
	contextuelles internes et on se sert de \alert{√ßa} comme entr√©e pour notre t√¢che cible.

	\pause

	Et qu'est-ce que vous pensez de ce qui se passe dans un \alert{mod√®le de langue}‚ÄØ?
\end{frame}

\begin{frame}{Wavelength collapse}
	Un tr√®s bon mod√®le de langue devrait contenir aussi des repr√©sentations en contexte
	
	\pause
	
	Et il doit probablement faire une forme de d√©sambig√ºisation.

	\pause

	Alors pourquoi ne pas shunter la d√©sambig√ºisation et utiliser directement ces
	\alert{repr√©sentations contextuelles}-l√†‚ÄØ?

	\pause

	C'est exactement ce qui s'est produit avec quasi-simultan√©ment
	\textcite{devlin2019BERTPretrainingDeep, howard2018UniversalLanguageModel,
	peters2018DeepContextualizedWord, radford2018ImprovingLanguageUnderstanding}

	(BERT, ULMFit, ELMo, GPT‚ÄØ: diverses formes d'entra√Ænement de repr√©sentations √† partir de formes
	de mod√®les de langue)

\end{frame}

\begin{frame}{Killing the game}
	Les repr√©sentations issues desdits mod√®les ont pris d'assaut le TAL, la linguistique
	informatique, les esprits et la soci√©t√©.

	\pause

	Il faut dire qu'elles apportent des gains impressionnants de performances (lesquelles‚ÄØ?) \pause
	√† un co√ªt computationnel d√©fiant toute concurrence \pause (monstrueux). \pause Mais peut-√™tre
	acceptable (???) selon ce qu'on veut faire.

	\pause

	De fait, ce qui se passe‚ÄØ: quand on veut une repr√©sentation vectorielle d'un mot (dans un
	contexte) on a plus seulement √† aller la chercher dans un \alert{dictionnaire}, mais on doit √†
	chaque fois faire passer tout le contexte dans un \alert{mod√®le} qui peut √™tre tr√®s lourd.
 \end{frame}

\begin{frame}{Transfert}
	Si on fait un pas en arri√®re sur ce dont on vient de parler, du point de vue de
	l'apprentissage‚ÄØ:

	\pause

	\begin{itemize}[<+->]
		\item On a appris un mod√®le pour une certaine t√¢che.
		\item Puis on prend ce mod√®le, on lui ajoute une surcouche et on entra√Æne l'ensemble sur une
		      nouvelle t√¢che.
		\item D'une certaine fa√ßon, on a \alert{transf√©r√©} des connaissances d'une t√¢che vers une
		      autre.
	\end{itemize}
\end{frame}

\begin{frame}{\textlang{english}{\emph{Transfer learning}}}
	Cette id√©e est parall√®le √† celle de l'\alert{apprentissage par transfert} en g√©n√©ral.

	\pause

	Pour le dire vite‚ÄØ: si on a un mod√®le qui marche bien pour un contexte \(X\), c'est peut-√™tre
	moins co√ªteux et plus efficace de l'\enquote{\alert{adapter}} pour un contexte \(Y\) que de
	faire un mod√®le pour \(Y\) √† partir de z√©ro.

	\pause

	√áa a √©t√© essay√© pour plein de combinaisons de \(X\) et \(Y\)
	(\textcite{ruder2019NeuralTransferLearning} pour un bon historique).

	\begin{itemize}
		\item D'une langue √† une autre.
		\item Entre domaines de sp√©cialit√©.
		\item Entre t√¢ches proches (POS/parsing/‚Ä¶)
	\end{itemize}
\end{frame}

\begin{frame}{Adaptation}
	\alert{Adapter} un mod√®le concr√®tement √ßa peut √™tre

	\pause

	\begin{itemize}[<+->]
		\item Juste prendre le mod√®le de base et lui donner de nouvelles donn√©es.
			\begin{itemize}
				\item[‚Üí] Faisable aussi pour le mod√®le de repr√©sentation‚ÄØ!
			\end{itemize}
		\item Ajouter des sur-/sous-/inter-couches dans le mod√®le qui g√®rent l'adaptation‚ÄØ:
			\begin{itemize}
				\item[‚Üí] En continuant √† entra√Æner les param√®tres du mod√®le original
				         (\quoteforeign{english}{\alert{fine-tuning}}).
				\item[‚Üí] En fixant les param√®tres du mod√®le original et juste entra√Æner les
				         nouvelles parties.
			\end{itemize}
	\end{itemize}

	\pause

	On peut aussi envisager plusieurs entra√Ænements simultan√©s, en \alert{multi-t√¢ches} (en partageant des repr√©sentations), c'est d'ailleurs d√©j√† ce que faisait \textcite{bengio2006NeuralProbabilisticLanguage}.
\end{frame}

\begin{frame}{Cas pratique‚ÄØ: d√©tection des cha√Ænes de cor√©f√©rences}
	\begin{center}
		\begin{tabular}{c*{5}{S}}
			\toprule
			{\textbf{System}}	& {\textbf{MUC}}	& {\textbf{B¬≥}}	& {\textbf{CEAF\textsubscript{e}}}	& {\textbf{CoNLL}}	& {\textbf{BLANC}}\\
			\midrule
			No pretraining & 62.15 & 81.24 & 81.29 & 74.89 & 69.50\\
			frELMo & 67.06 & 82.53 & 83.56 & 77.72 & 71.74\\
			mBERT & 64.02 & 81.67 & 82.40 & 76.03 & 70.42\\
			CamemBERT & 67.32 & 82.53 & 83.63 & 77.83 & 71.96\\
			frELMo+str & \textbf{72.50} & 84.24 & 86.21 & \textbf{80.98} & \textbf{74.15}\\  % 2019-10-09-ANCOR-frELMOv0.3+str
			CamemBERT+str & 72.34 & \textbf{84.42} & \textbf{86.37} & \textbf{81.04} & \textbf{74.24}\\  % 2019-10-09-ANCOR-frELMOv0.3+str
			\bottomrule
		\end{tabular}
	\end{center}
\end{frame}

\begin{frame}{Cas pratique‚ÄØ: analyse syntaxique de l'ancien fran√ßais}
	\begin{center}
		\begin{tabular}{l*{3}{S[table-format=2.2]}}
			\toprule
			{\textbf{Model}} & {\textbf{UPOS}} & {\textbf{UAS}} & {\textbf{LAS}}\\
			\midrule
			SotA & 96.26 & 91.83 & 86.75\\
			\midrule
			mBERT	& 96.19 & 92.03 & 87.52\\
			BERTrade      & 96.60 & 92.20 & 87.95\\
			mBERT+OF      & 97.11 & 93.86 & 90.37\\
			FlauBERT+OF   & 97.15 & 93.96 & 90.57\\
			\bottomrule
		\end{tabular}
	\end{center}
\end{frame}

\begin{frame}{Cas pratique‚ÄØ: traduction Breton‚ÜíFran√ßais}
	\begin{center}
		\begin{tabular}{l*{2}{S[table-format=2.2]}S[table-format=3.2]}
			\toprule
			{\textbf{Model}} & {\textbf{BLEU}} & {\textbf{ChrF++}} & {\textbf{TER}}\\
			\midrule
			Apertium            & 24.15 & 50.23 &  63.93\\
			m2m100-418M         & 00.58 & 11.85 & 114.49\\
			\quad +OPUS         & 30.01 & 50.16 &  55.37\\
			\quad\quad +ARBRES  & 37.68 & 56.99 &  48.65\\
			\bottomrule
		\end{tabular}
	\end{center}
\end{frame}


%  ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà
% ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà
% ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà‚ñà
% ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà      ‚ñà‚ñà      ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà
% ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà      ‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà

\hypersetup{bookmarksdepth=0}  % Don't create the bookmark for the Appendix part
\appendix
\hypersetup{bookmarksdepth=2}
\bookmarksetup{startatroot}
\section{Appendix}

\pdfbookmark[3]{References}{references}
\begin{frame}[allowframebreaks]{References}
	\printbibliography[heading=none]
\end{frame}

\pdfbookmark[3]{Licence}{licence}
\begin{frame}{Licence}
	\begin{english}
		\begin{center}
			{\huge \ccby}
			\vfill
			This document is distributed under the terms of the Creative Commons Attribution 4.0 International Licence (CC BY 4.0) (\shorturl{creativecommons.org/licenses/by/4.0})

			\vfill
			¬© 2024, L. Grobol <\shorturl[mailto][:]{loic.grobol@gmail.com}>

			\shorturl[https]{lgrobol.eu}
		\end{center}
	\end{english}
\end{frame}

\end{document}
